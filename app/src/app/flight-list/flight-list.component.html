<div class="flight-list-container">
  <header class="page-header">
    <h1 class="page-title">Your Flights</h1>
    <div class="header-buttons">
      <button mat-fab extended color="primary" [routerLink]="['/flight', 'new']">
        <mat-icon>add</mat-icon>
        Add Flight
      </button>
      <button mat-fab extended color="accent" [routerLink]="['/trip-wizard']">
        <mat-icon>travel_explore</mat-icon>
        Add Trip
      </button>
    </div>
  </header>

  <div class="main-content">
    <!-- Map Section -->
    <div class="map-section">
      <app-cesium *ngIf="flights()" [flights]="flights()" [showCountries]="mapOptions.countries"></app-cesium>
    </div>

    <!-- Stats Panel -->
    <aside class="stats-panel">
      <!-- Map Options Card -->
      <mat-card class="map-options-card glass-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>tune</mat-icon>
          <mat-card-title>Map Options</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="option-row">
            <mat-slide-toggle [(ngModel)]="mapOptions.countries" color="primary">
              Show visited Countries
            </mat-slide-toggle>
          </div>
          <div class="option-row">
            <mat-form-field appearance="outline" class="trip-filter-field">
              <mat-label>Filter by Trip</mat-label>
              <mat-select [(ngModel)]="selectedTripId">
                <mat-option value="all">All Flights</mat-option>
                <mat-option value="none">No Trip</mat-option>
                @for (trip of trips(); track trip._id) {
                <mat-option [value]="trip._id">üåç {{ trip.name }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Flight Summary Component -->
      <app-flight-summary-card [stats]="stats()" [compact]="true"></app-flight-summary-card>
    </aside>
  </div>

  <!-- Flight Cards Grid -->
  <section class="flights-grid">
    @for (flight of flights(); track flight._id) {
    <app-flight-card [flight]="flight">
      <app-flight-tile [flight]="flight" [tripName]="getTripName(flight)"></app-flight-tile>
    </app-flight-card>
    }
  </section>
</div>